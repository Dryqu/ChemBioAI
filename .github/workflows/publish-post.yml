name: Publish Post (from Issue)


on:
issues:
types: [opened, edited]


permissions:
contents: write
issues: write


jobs:
publish:
if: >
github.event.issue.state == 'open' &&
contains(join(github.event.issue.labels.*.name, ','), 'publish') &&
github.actor != 'github-actions[bot]'
runs-on: ubuntu-latest


steps:
- name: Checkout repo
uses: actions/checkout@v4


- name: Set up Python
uses: actions/setup-python@v5
with:
python-version: '3.11'


- name: Publish post
env:
ISSUE_TITLE: ${{ github.event.issue.title }}
ISSUE_BODY: ${{ github.event.issue.body }}
ISSUE_NUMBER: ${{ github.event.issue.number }}
REPO: ${{ github.repository }}
GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
run: python tools/publish_from_issue.py


- name: Push changes
run: git push
